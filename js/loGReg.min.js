
  firebase.initializeApp(firebaseConfig);
  function login(){var e=document.getElementById("login-email").value,t=document.getElementById("login-password").value;firebase.auth().signInWithEmailAndPassword(e,t).then(e=>{var t=e.user;document.getElementById("user-info").style.display="block",document.getElementById("dashboard").style.display="block",document.getElementById("user-displayname").textContent=t.displayName||"User",document.getElementById("user-role").textContent="Fetching role...",document.getElementById("dashboard-email").textContent=t.email,showUserPhoto(t),showUserData(t.uid),fetchUserRole(t.uid),document.getElementById("message").innerHTML="Logged in as "+t.email}).catch(e=>{document.getElementById("message").innerHTML="Error: "+e.message})}function resetPassword(){var e=document.getElementById("login-email").value;firebase.auth().sendPasswordResetEmail(e).then(()=>{document.getElementById("message").innerHTML="Password reset email sent!"}).catch(e=>{document.getElementById("message").innerHTML="Error: "+e.message})}function register(){var e=document.getElementById("register-email").value,t=document.getElementById("register-password").value,a=document.getElementById("register-displayname").value;document.getElementById("register-photo").files[0],firebase.auth().createUserWithEmailAndPassword(e,t).then(t=>{var s=t.user;s.updateProfile({displayName:a}).then(()=>{document.getElementById("user-info").style.display="block",document.getElementById("dashboard").style.display="block",document.getElementById("user-displayname").textContent=a,document.getElementById("dashboard-email").textContent=e,showUserPhoto(s),showUserData(s.uid),fetchUserRole(s.uid),document.getElementById("message").innerHTML="Registered as "+s.email}).catch(e=>{document.getElementById("message").innerHTML="Error: "+e.message})}).catch(e=>{document.getElementById("message").innerHTML="Error: "+e.message})}function logout(){firebase.auth().signOut().then(()=>{document.getElementById("user-info").style.display="none",document.getElementById("dashboard").style.display="none",document.getElementById("message").innerHTML="Logged out successfully!"}).catch(e=>{document.getElementById("message").innerHTML="Error: "+e.message})}function updateProfile(){var e=prompt("Enter new display name:");null!==e&&""!==e.trim()&&firebase.auth().currentUser.updateProfile({displayName:e}).then(()=>{document.getElementById("user-displayname").textContent=e,document.getElementById("dashboard-displayname").textContent=e,document.getElementById("message").innerHTML="Display name updated!"}).catch(e=>{document.getElementById("message").innerHTML="Error: "+e.message})}function showUserPhoto(e){var t=document.getElementById("user-photo-container");if(t.innerHTML=" ",e.photoURL){var a=document.createElement("img");a.src=e.photoURL,a.alt="Profile Picture",a.classList.add("profile-picture"),t.appendChild(a)}}function fetchUserRole(e){firebase.database().ref("roles/"+e).once("value").then(e=>{var t=e.val();document.getElementById("user-role").textContent=t||"User",document.getElementById("dashboard-role").textContent=t||"User"}).catch(e=>{document.getElementById("message").innerHTML="Error: "+e.message})}function showUserData(e){firebase.database().ref("user_data/"+e).once("value").then(e=>{var t=e.val(),a=document.getElementById("dashboard-user-data");if(a.innerHTML="",t)Object.keys(t).forEach(e=>{var s=document.createElement("p");s.textContent=e+": "+t[e],a.appendChild(s)});else{var s=document.createElement("p");s.textContent="No user-specific data found.",a.appendChild(s)}}).catch(e=>{document.getElementById("message").innerHTML="Error: "+e.message})}function login(){var e=document.getElementById("login-email").value,t=document.getElementById("login-password").value;firebase.auth().signInWithEmailAndPassword(e,t).then(e=>{var t=e.user;document.getElementById("user-info").style.display="block",document.getElementById("dashboard").style.display="block",document.getElementById("user-displayname").textContent=t.displayName||"User",document.getElementById("user-role").textContent="Fetching role...",document.getElementById("dashboard-email").textContent=t.email,showUserPhoto(t),showUserData(t.uid),fetchUserRole(t.uid),alert("Logged in as "+t.email)}).catch(e=>{alert("Error: "+e.message)})}function resetPassword(){var e=document.getElementById("login-email").value;firebase.auth().sendPasswordResetEmail(e).then(()=>{alert("Password reset email sent!")}).catch(e=>{alert("Error: "+e.message)})}function register(){var e=document.getElementById("register-email").value,t=document.getElementById("register-password").value,a=document.getElementById("register-displayname").value;document.getElementById("register-photo").files[0],firebase.auth().createUserWithEmailAndPassword(e,t).then(t=>{var s=t.user;s.updateProfile({displayName:a}).then(()=>{document.getElementById("user-info").style.display="block",document.getElementById("dashboard").style.display="block",document.getElementById("user-displayname").textContent=a,document.getElementById("dashboard-email").textContent=e,showUserPhoto(s),showUserData(s.uid),fetchUserRole(s.uid),alert("Registered as "+s.email)}).catch(e=>{alert("Error: "+e.message)})}).catch(e=>{alert("Error: "+e.message)})}function fetchUserRole(e){firebase.database().ref("roles/"+e).once("value").then(e=>{var t=e.val();document.getElementById("user-role").textContent=t||"User",document.getElementById("dashboard-role").textContent=t||"User"}).catch(e=>{alert("Error: "+e.message)})}function showUserData(e){firebase.database().ref("user_data/"+e).once("value").then(e=>{var t=e.val(),a=document.getElementById("dashboard-user-data");if(a.innerHTML="",t)Object.keys(t).forEach(e=>{var s=document.createElement("p");s.textContent=e+": "+t[e],a.appendChild(s)});else{var s=document.createElement("p");s.textContent="No user-specific data found.",a.appendChild(s)}}).catch(e=>{alert("Error: "+e.message)})}function updateEmail(){var e=prompt("Enter new email address:");null!==e&&""!==e.trim()&&firebase.auth().currentUser.updateEmail(e).then(()=>{document.getElementById("dashboard-email").textContent=e,showMessage("Email updated successfully!","success")}).catch(e=>{showMessage("Error: "+e.message,"error")})}function updatePassword(){var e=prompt("Enter new password:");null!==e&&""!==e.trim()&&firebase.auth().currentUser.updatePassword(e).then(()=>{showMessage("Password updated successfully!","success")}).catch(e=>{showMessage("Error: "+e.message,"error")})}function deleteAccount(){confirm("Are you sure you want to delete your account? This action cannot be undone!")&&firebase.auth().currentUser.delete().then(()=>{var e=firebase.auth().currentUser.uid;firebase.database().ref("user_data/"+e).remove(),showMessage("Account deleted successfully!","success"),document.getElementById("user-info").style.display="none",document.getElementById("dashboard").style.display="none"}).catch(e=>{showMessage("Error: "+e.message,"error")})}firebase.auth().onAuthStateChanged(e=>{e?(document.getElementById("user-info").style.display="block",document.getElementById("dashboard").style.display="block",document.getElementById("login-form").style.display="none",document.getElementById("register-form").style.display="none",document.getElementById("dashboard-email").textContent=e.email,document.getElementById("user-displayname").textContent=e.displayName||"User",showUserPhoto(e),showUserData(e.uid),fetchUserRole(e.uid)):(document.getElementById("user-info").style.display="none",document.getElementById("dashboard").style.display="none",document.getElementById("login-form").style.display="block",document.getElementById("register-form").style.display="block")});
  function fetchUserRole(e){firebase.database().ref("roles/"+e).once("value").then(e=>{var t=e.val();document.getElementById("user-role").textContent=t||"User",document.getElementById("dashboard-role").textContent=t||"User"}).catch(e=>{alert("Error: "+e.message)}),document.getElementById("dashboard-user-id").textContent=e}function updatePhoneNumber(){var e=prompt("Enter new phone number:");if(null!==e&&""!==e.trim()){var t=firebase.auth().currentUser.uid;firebase.database().ref("user_data/"+t).update({phone:e}).then(()=>{document.getElementById("dashboard-phone").textContent=e,alert("Phone number updated successfully!")}).catch(e=>{alert("Error: "+e.message)})}}function showUserData(e){firebase.database().ref("user_data/"+e).once("value").then(e=>{var t=e.val(),a=document.getElementById("dashboard-user-data");if(a.innerHTML="",t)Object.keys(t).forEach(e=>{var n=document.createElement("p");n.textContent=e+": "+t[e],a.appendChild(n)}),document.getElementById("dashboard-phone").textContent=t.phone||"N/A";else{var n=document.createElement("p");n.textContent="No user-specific data found.",a.appendChild(n)}}).catch(e=>{alert("Error: "+e.message)})}function showRegisterForm(){document.getElementById("register-form").style.display="block"} function register(){var e=document.getElementById("register-email").value,t=document.getElementById("register-password").value,r=document.getElementById("register-displayname").value,i=document.getElementById("register-photo").files[0];firebase.auth().createUserWithEmailAndPassword(e,t).then(e=>{var t=e.user;t.updateProfile({displayName:r}).then(()=>{if(i){var e=firebase.storage().ref("profile_photos/"+t.uid);e.put(i).then(()=>e.getDownloadURL()).then(e=>{t.updateProfile({photoURL:e}).then(()=>{t.sendEmailVerification().then(()=>{alert("Registration completed! Please check your email to verify your account."),document.getElementById("register-email").value="",document.getElementById("register-password").value="",document.getElementById("register-displayname").value=""}).catch(e=>{console.error("Error sending verification email: ",e)})}).catch(e=>{console.error("Error updating profile photo: ",e)})}).catch(e=>{console.error("Error uploading profile photo: ",e)})}else t.sendEmailVerification().then(()=>{alert("Registration completed! Please check your email to verify your account."),document.getElementById("register-email").value="",document.getElementById("register-password").value="",document.getElementById("register-displayname").value=""}).catch(e=>{console.error("Error sending verification email: ",e)})}).catch(e=>{console.error("Error updating display name: ",e)})}).catch(e=>{console.error("Error creating user: ",e)})}function login(){var e=document.getElementById("login-email").value,t=document.getElementById("login-password").value;firebase.auth().signInWithEmailAndPassword(e,t).then(e=>{var t=e.user;t.emailVerified?alert("Login successful!"):(alert("Please verify your email before logging in. Check your inbox for the verification email."),sendVerificationEmail(t),firebase.auth().signOut())}).catch(e=>{console.error("Error logging in: ",e)})}function sendVerificationEmail(e){e.sendEmailVerification().then(()=>{alert("Verification email sent! Please check your email to verify your account.")}).catch(e=>{console.error("Error sending verification email: ",e)})}firebase.auth().onAuthStateChanged(e=>{e?e.emailVerified?(document.getElementById("user-info").style.display="block",document.getElementById("dashboard").style.display="block",document.getElementById("login-form").style.display="none",document.getElementById("register-form").style.display="none",document.getElementById("dashboard-email").textContent=e.email,document.getElementById("user-displayname").textContent=e.displayName||"User",showUserPhoto(e),showUserData(e.uid),fetchUserRole(e.uid)):(document.getElementById("user-info").style.display="none",document.getElementById("dashboard").style.display="none",document.getElementById("login-form").style.display="block",document.getElementById("register-form").style.display="block",alert("Please verify your email before accessing the dashboard. Check your inbox for the verification email."),firebase.auth().signOut()):(document.getElementById("user-info").style.display="none",document.getElementById("dashboard").style.display="none",document.getElementById("login-form").style.display="block",document.getElementById("register-form").style.display="block")});
  function register(){var e=document.getElementById("register-email").value,r=document.getElementById("register-password").value,i=document.getElementById("register-displayname").value;if(!e||!r||!i){alert("Please fill in all the required fields.");return}firebase.auth().createUserWithEmailAndPassword(e,r).then(e=>{var r=e.user;r.updateProfile({displayName:i}).then(()=>{r.sendEmailVerification().then(()=>{alert("Registration successful. Verification email sent."),window.location.href="https://www.codemind.eu.org/p/user-interface.html"}).catch(e=>{alert("Error sending verification email: "+e.message)})}).catch(e=>{alert("Error updating display name: "+e.message)})}).catch(e=>{alert("Error registering user: "+e.message)})}
